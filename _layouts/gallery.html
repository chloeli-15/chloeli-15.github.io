---
layout: default
---
<article class="gallery">
    <header class="gallery-header">
        <h1 class="gallery-title">{{ page.title | escape }}</h1>
        {% if page.description %}
        <p class="gallery-description">{{ page.description }}</p>
        {% endif %}
    </header>
    <div class="gallery-content">
        {{ content }}
        {% if page.gallery_path %}
        <div class="photo-grid">
            {% assign image_files = site.static_files | where_exp: "file", "file.path contains page.gallery_path" %}
            {% for image in image_files %}
            <div class="photo-item">
                <img src="{{ image.path | relative_url }}" alt="{{ image.name }}" loading="lazy">
            </div>
            {% else %}
            <p>No images found in the specified gallery path.</p>
            {% endfor %}
        </div>
        {% else %}
        <p>No gallery path specified.</p>
        {% endif %}
    </div>
</article>
<script src="https://unpkg.com/masonry-layout@4/dist/masonry.pkgd.min.js"></script>
<script>
    document.addEventListener('DOMContentLoaded', function () {
        const grid = document.querySelector('.photo-grid');
        const items = grid.querySelectorAll('.photo-item');

        let msnry;

        function initMasonry() {
            msnry = new Masonry(grid, {
                itemSelector: '.photo-item',
                columnWidth: '.photo-item',
                percentPosition: true
            });
        }

        function handleImage(item) {
            const img = item.querySelector('img');
            if (img.complete) {
                setImageSize(item, img);
            } else {
                img.addEventListener('load', () => setImageSize(item, img));
            }
        }

        function setImageSize(item, img) {
            const ratio = img.naturalWidth / img.naturalHeight;
            let width = 1;

            if (ratio > 1.5) width = 2;
            if (ratio > 2) width = 3;

            item.style.width = `${width * 25}%`;
            msnry.layout();
        }

        items.forEach(handleImage);
        initMasonry();

        // Recalculate sizes on window resize
        window.addEventListener('resize', () => {
            items.forEach(handleImage);
            msnry.layout();
        });
    });
</script>
<style>
    .photo-grid {
        width: 100%;
    }

    .photo-item {
        width: 25%;
        padding: 5px;
        box-sizing: border-box;
    }

    .photo-item img {
        width: 100%;
        height: auto;
        display: block;
    }

    @media (max-width: 1200px) {
        .photo-item {
            width: 33.333%;
        }
    }

    @media (max-width: 800px) {
        .photo-item {
            width: 50%;
        }
    }

    @media (max-width: 500px) {
        .photo-item {
            width: 100%;
        }
    }
</style>